---
title: "Running a dyadic regression"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{dyadic_regression}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(bisonR)
library(tidyverse)
```

```{r}
data("binary_ex1")
df <- binary_ex1
head(df)
```

```{r}
df_reg <- data.frame(
  node = as.factor(c("Rey", "Leia", "Obi-Wan", "Luke", "C-3PO", "BB-8", "R2-D2", "D-O")),
  node_type = as.factor(c("Lifeform", "Lifeform", "Lifeform", "Lifeform", "Droid", "Droid", "Droid", "Droid"))
)
df_reg
```

```{r}
draw_node_metric_samples(fit_edge, "strength", 100)
```

```{r}
fit_node <- nodal_regression(strength(node_names) ~ node_type, fit_edge, df_reg)
```

```{r}
quantile(rstan::extract(fit_node$fit)$beta_fixed[, 3] - rstan::extract(fit_node$fit)$beta_fixed[, 2])
```

```{r}
plot_trace(fit_dyad)
```

```{r}
plot_predictions(fit_dyad, num_draws=20)
```
