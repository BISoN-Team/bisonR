}
print(round(softmax(prob_k_id), 5))
}
# Each column can give P(i in C_k | K = k)
for (id in 1:10){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
}
}
print(round(prob_k_id, 5))
}
num_samples <- dim(fit_edge$edge_samples)[1]
num_samples <- 200
num_edges <- dim(fit_edge$edge_samples)[2]
max_num_components <- 5
pb <- txtProgressBar(max=num_samples, style=3)
component_probabilities <- matrix(0, num_samples, max_num_components)
component_id_probabilities <- array(0, c(num_samples, max_num_components, num_edges))
for (i in 1:num_samples) {
setTxtProgressBar(pb, i)
fit_mixtures <- list()
for (k in 1:max_num_components) {
fit_mixtures[[k]] <- Mclust(fit_edge$edge_samples[i, ], G=k, verbose=FALSE)
}
bics <- sapply(fit_mixtures, function(x) x$BIC[1])
bics_diff <- max(bics) - bics
half_exp_diffs <- exp(-0.5 * bics_diff)
component_probabilities[i, ] <- half_exp_diffs/sum(half_exp_diffs)
component_id_probabilities[i, , ] <- t(sapply(fit_mixtures, function(x) x$classification))
}
close(pb)
component_id_probabilities[, , 1]
# Each column can give P(i in C_k | K = k)
for (id in 1:10){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
}
}
print(round(prob_k_id, 5))
print(sum(prob_k_id))
}
# Each column can give P(i in C_k | K = k)
for (id in 1:10){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
}
}
print(round(prob_k_id, 5))
print(sum(prob_k_id))
}
# Each column can give P(i in C_k | K = k)
for (id in 1:10){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
}
}
print(round(prob_k_id, 5))
print(sum(prob_k_id))
}
# Each column can give P(i in C_k | K = k)
for (id in 1:10){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + prob_k[l] * mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
}
}
print(round(prob_k_id, 5))
print(sum(prob_k_id))
}
dim(component_id_probabilities)
for (id in 1:10){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + prob_k[l] * mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
}
}
print(round(prob_k_id, 5))
print(sum(prob_k_id))
}
# Each column can give P(i in C_k | K = k)
for (id in 1:10){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + prob_k[k] * mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
}
}
print(round(prob_k_id, 5))
print(sum(prob_k_id))
}
# Each column can give P(i in C_k | K = k)
for (id in 1:10){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + prob_k[k] * mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
}
}
print(prob_k_id, 5)
print(sum(prob_k_id))
}
component_id_probabilities
component_id_probabilities[, k, id] == l
component_id_probabilities[, 1, id]
component_id_probabilities[, 1, 1]
component_id_probabilities[, 2, 1]
component_id_probabilities[, 3, 1]
component_id_probabilities[, 3, 1] == 3
mean(component_id_probabilities[, 3, 1] == 3)
component_id_probabilities[, 3, 1]
mean(component_id_probabilities[, 3, 1] == 1)
mean(component_id_probabilities[, 3, 1] == 2)
mean(component_id_probabilities[, 3, 1] == 3)
component_probabilities
mean(component_id_probabilities[, 3, 1] == 2) * prob_k[2]
mean(component_id_probabilities[, 3, 1] == 2) * prob_k[3]
# Each column can give P(i in C_k | K = k)
for (id in 1:100){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + prob_k[k] * mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
}
}
print(prob_k_id, 5)
print(sum(prob_k_id))
}
# Each column can give P(i in C_k | K = k)
for (id in 1:1){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + prob_k[k] * mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
}
}
print(prob_k_id, 5)
print(sum(prob_k_id))
}
prob_k_id
component_id_probabilities[, k, id]
k
id
prob_k[k]
mean(component_id_probabilities[, k, id] == l)
# Each column can give P(i in C_k | K = k)
for (id in 1:1){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + prob_k[k] * mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
print(prob_k[k] * mean(component_id_probabilities[, k, id] == l))
}
}
print(prob_k_id, 5)
print(sum(prob_k_id))
}
num_samples <- dim(fit_edge$edge_samples)[1]
num_samples <- 200
num_edges <- dim(fit_edge$edge_samples)[2]
max_num_components <- 5
pb <- txtProgressBar(max=num_samples, style=3)
component_probabilities <- matrix(0, num_samples, max_num_components)
component_id_probabilities <- array(0, c(num_samples, max_num_components, num_edges))
for (i in 1:num_samples) {
setTxtProgressBar(pb, i)
fit_mixtures <- list()
for (k in 1:max_num_components) {
fit_mixtures[[k]] <- Mclust(fit_edge$edge_samples[i, ], G=k, verbose=FALSE)
}
bics <- sapply(fit_mixtures, function(x) x$BIC[1])
bics_diff <- max(bics) - bics
half_exp_diffs <- exp(-0.5 * bics_diff)
component_probabilities[i, ] <- half_exp_diffs/sum(half_exp_diffs)
component_id_probabilities[i, , ] <- t(sapply(fit_mixtures, function(x) x$classification))
}
close(pb)
component_id_probabilities[, , 1]
# Each column can give P(i in C_k | K = k)
for (id in 1:1){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + prob_k[k] * mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
print(k, l, prob_k[k] * mean(component_id_probabilities[, k, id] == l))
}
}
print(prob_k_id, 5)
print(sum(prob_k_id))
}
# Each column can give P(i in C_k | K = k)
for (id in 1:1){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + prob_k[k] * mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
print(k, l, prob_k[k] * mean(component_id_probabilities[, k, id] == l))
}
}
print(prob_k_id, 5)
print(sum(prob_k_id))
}
# Each column can give P(i in C_k | K = k)
for (id in 1:1){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + prob_k[k] * mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
print(paste(k, l, prob_k[k] * mean(component_id_probabilities[, k, id] == l)))
}
}
print(prob_k_id, 5)
print(sum(prob_k_id))
}
component_id_probabilities
dim(component_id_probabilities)
apply(component_id_probabilities[, , 1], 1, mean)
apply(component_id_probabilities[, , 1], 1, median)
dim(component_id_probabilities)
apply(component_id_probabilities[, , 1], 2, function(x) mean(x == 1))
apply(component_id_probabilities[, , 1], 2, function(x) mean(x == 2))
apply(component_id_probabilities[, , 1], 2, function(x) mean(x == 3))
dim(component_id_probabilities)
apply(component_id_probabilities[, , 1], 1, which.max)
apply(component_id_probabilities[, , 1], 1, function(x) mean(x == 3))
apply(component_id_probabilities[, , 1], 2, function(x) mean(x == 3))
apply(component_id_probabilities[, , 1], 2, function(x) mean(x == 1))
apply(component_id_probabilities[, , 1], 2, function(x) mean(x == 2))
apply(component_id_probabilities[, , 1], 2, function(x) mean(x == 3))
dim(component_id_probabilities)
component_id_probabilities
dim(component_id_probabilities)
component_id_probabilities[, , 1]
apply(component_id_probabilities[, , 1], 2, function(x) mean(x == 1))
# Each column can give P(i in C_k | K = k)
for (id in 1:1){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + prob_k[l] * mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
# print(paste(k, l, prob_k[k] * mean(component_id_probabilities[, k, id] == l)))
}
}
print(prob_k_id, 5)
print(sum(prob_k_id))
}
# Each column can give P(i in C_k | K = k)
for (id in 1:10){
prob_k <- apply(component_probabilities, 2, mean)
prob_k_id <- rep(0, max_num_components)
for (k in 1:max_num_components) {
for (l in 1:k) {
prob_k_id[k] <- prob_k_id[k] + prob_k[l] * mean(component_id_probabilities[, k, id] == l) # P(i in C_1 | K = 1)
# print(paste(k, l, prob_k[k] * mean(component_id_probabilities[, k, id] == l)))
}
}
print(prob_k_id, 5)
print(sum(prob_k_id))
}
component_probabilities
num_samples <- dim(fit_edge$edge_samples)[1]
num_samples <- 200
num_edges <- dim(fit_edge$edge_samples)[2]
max_num_components <- 5
pb <- txtProgressBar(max=num_samples, style=3)
component_probabilities <- matrix(0, num_samples, max_num_components)
component_id_probabilities <- array(0, c(num_samples, max_num_components, num_edges))
for (i in 1:num_samples) {
setTxtProgressBar(pb, i)
fit_mixtures <- list()
for (k in 1:max_num_components) {
fit_mixtures[[k]] <- Mclust(fit_edge$edge_samples[i, ], G=k, verbose=FALSE)
}
bics <- sapply(fit_mixtures, function(x) x$BIC[1])
bics_diff <- max(bics) - bics
half_exp_diffs <- exp(-0.5 * bics_diff)
component_probabilities[i, ] <- half_exp_diffs/sum(half_exp_diffs)
component_id_probabilities[i, , ] <- t(sapply(fit_mixtures, function(x) x$classification))
}
close(pb)
component_probabilities_mean <- apply(component_probabilities, 2, mean)
component_probabilities_mean
dim(component_id_probabilities)
num_samples <- dim(fit_edge$edge_samples)[1]
num_samples <- 200
num_edges <- dim(fit_edge$edge_samples)[2]
max_num_components <- 5
pb <- txtProgressBar(max=num_samples, style=3)
component_probabilities <- matrix(0, num_samples, max_num_components)
edge_components <- array(0, c(num_samples, max_num_components, num_edges))
for (i in 1:num_samples) {
setTxtProgressBar(pb, i)
fit_mixtures <- list()
for (k in 1:max_num_components) {
fit_mixtures[[k]] <- Mclust(fit_edge$edge_samples[i, ], G=k, verbose=FALSE)
}
bics <- sapply(fit_mixtures, function(x) x$BIC[1])
bics_diff <- max(bics) - bics
half_exp_diffs <- exp(-0.5 * bics_diff)
component_probabilities[i, ] <- half_exp_diffs/sum(half_exp_diffs)
edge_components[i, , ] <- t(sapply(fit_mixtures, function(x) x$classification))
}
close(pb)
component_probabilities_mean <- apply(component_probabilities, 2, mean)
component_probabilities_mean
dim(edge_components)
edge_components[, 3, ]
apply(edge_components[, 3, ], 2, function(x) mean(x == 3))
apply(edge_components[, 3, ], 1, function(x) mean(x == 3))
apply(edge_components[, 3, ], 2, function(x) mean(x == 3))
apply(edge_components[, 3, ], 2, function(x) mean(x == 1))
apply(edge_components[, 3, ], 2, function(x) mean(x == 2))
apply(edge_components[, 3, ], 2, function(x) mean(x == 3))
cbind(c(
apply(edge_components[, 3, ], 2, function(x) mean(x == 1)),
apply(edge_components[, 3, ], 2, function(x) mean(x == 2)),
apply(edge_components[, 3, ], 2, function(x) mean(x == 3))
))
cbind(
apply(edge_components[, 3, ], 2, function(x) mean(x == 1)),
apply(edge_components[, 3, ], 2, function(x) mean(x == 2)),
apply(edge_components[, 3, ], 2, function(x) mean(x == 3))
)
cbind(sapply(1:3, function(i) {apply(edge_components[, 3, ], 2, function(x) mean(x == i))})
cbind(sapply(1:3, function(i) {apply(edge_components[, 3, ], 2, function(x) mean(x == i))})
cbind(sapply(1:3, function(i) {apply(edge_components[, 3, ], 2, function(x) mean(x == i))}))
num_samples <- dim(fit_edge$edge_samples)[1]
num_samples <- 200
num_edges <- dim(fit_edge$edge_samples)[2]
max_num_components <- 5
pb <- txtProgressBar(max=num_samples, style=3)
component_probability_samples <- matrix(0, num_samples, max_num_components)
edge_component_samples <- array(0, c(num_samples, max_num_components, num_edges))
for (i in 1:num_samples) {
setTxtProgressBar(pb, i)
fit_mixtures <- list()
for (k in 1:max_num_components) {
fit_mixtures[[k]] <- Mclust(fit_edge$edge_samples[i, ], G=k, verbose=FALSE)
}
bics <- sapply(fit_mixtures, function(x) x$BIC[1])
bics_diff <- max(bics) - bics
half_exp_diffs <- exp(-0.5 * bics_diff)
component_probability_samples[i, ] <- half_exp_diffs/sum(half_exp_diffs)
edge_component_samples[i, , ] <- t(sapply(fit_mixtures, function(x) x$classification))
}
close(pb)
component_probabilities_mean <- apply(component_probabilities, 2, mean)
component_probabilities_mean
get_edge_components <- function(k) {
cbind(sapply(1:k, function(i) {apply(edge_components[, k, ], 2, function(x) mean(x == i))}))
}
get_edge_components(3)
component_probabilities_mean <- apply(component_probability_samples, 2, mean)
component_probabilities_mean
get_edge_components <- function(k) {
cbind(sapply(1:k, function(i) {apply(edge_component_samples[, k, ], 2, function(x) mean(x == i))}))
}
get_edge_components(3)
get_edge_components(2)
get_edge_components(1)
get_edge_components(5)
get_edge_components(8)
devtools::load_all(".")
fit_mixture <- dyadic_mixture(fit_edge)
devtools::load_all(".")
fit_mixture <- dyadic_mixture(fit_edge)
devtools::load_all(".")
fit_mixture <- dyadic_mixture(fit_edge)
devtools::load_all(".")
fit_mixture <- dyadic_mixture(fit_edge)
devtools::load_all(".")
fit_mixture <- dyadic_mixture(fit_edge)
summary(fit_edge)
devtools::load_all(".")
library(dplyr)
sim_data <- simulate_edge_model_mixture("binary", num_components = 2, component_weights = c(0.5, 0.5))
df <- sim_data$df_sim
head(df)
hist(df$event/df$duration, breaks=20)
priors <- get_default_priors("binary")
priors
fit_edge <- edge_model(
(event | duration) ~ dyad(node_1_id, node_2_id),
data=df,
data_type="binary",
priors=priors
)
fit_mixture <- dyadic_mixture(fit_edge)
fit_mixture <- edge_mixture(fit_edge)
fit_mixture
summary(fit_mixture)
devtools::document()
devtools::load_all(".")
summary(fit_mixture)
devtools::load_all(".")
summary(fit_mixture)
devtools::load_all(".")
summary(fit_mixture)
devtools::load_all(".")
summary(fit_mixture)
devtools::load_all(".")
summary(fit_mixture)
devtools::load_all(".")
summary(fit_mixture)
devtools::load_all(".")
summary(fit_mixture)
fit_mixture <- edge_mixture(fit_edge, component_range = 2:6)
fit_mixture <- edge_mixture(fit_edge, component_range = 1:6)
summary(fit_mixture)
fit_mixture <- edge_mixture(fit_edge, component_range = 1:3)
summary(fit_mixture)
fit_mixture <- edge_mixture(fit_edge, component_range = 1:1)
summary(fit_mixture)
fit_mixture <- edge_mixture(fit_edge, component_range = 1:2)
summary(fit_mixture)
fit_mixture <- edge_mixture(fit_edge, component_range = 2:5)
devtools::load_all(".")
fit_mixture <- edge_mixture(fit_edge, component_range = 2:5)
devtools::load_all(".")
fit_mixture <- edge_mixture(fit_edge, component_range = 2:5)
devtools::load_all(".")
fit_mixture <- edge_mixture(fit_edge, component_range = 2:5)
test_list <- list()
test_list[2] <- 1
test_list
devtools::load_all(".")
fit_mixture <- edge_mixture(fit_edge, num_components=5)
fit_mixture <- edge_mixture(fit_edge, num_components=5)
devtools::load_all(".")
fit_mixture <- edge_mixture(fit_edge, num_components=5)
summary(fit_mixture)
matrix(c(1, 2, 3))
matrix(c(1, 2, 3), nrow=1)
devtools::load_all(".")
fit_mixture <- edge_mixture(fit_edge, num_components=5)
summary(fit_mixture)
library(bisonR)
library(dplyr)
devtools::load_all(".")
sim_data <- simulate_edge_model_mixture("binary", num_components = 2, component_weights = c(0.5, 0.5))
df <- sim_data$df_sim
head(df)
hist(df$event/df$duration, breaks=20)
priors <- get_default_priors("binary")
priors
fit_edge <- edge_model(
(event | duration) ~ dyad(node_1_id, node_2_id),
data=df,
data_type="binary",
priors=priors
)
fit_mixture <- edge_mixture(fit_edge, num_components=5)
summary(fit_mixture)
fit_mixture$edge_component_probabilities
fit_mixture$edge_component_probabilities
fit_mixture$edge_component_probabilities[[5]]
fit_mixture <- edge_mixture(fit_edge, num_components=5)
summary(fit_mixture)
fit_mixture$edge_component_probabilities[[2]]
df[88, ]
devtools::load_all(".")
library(dplyr)
sim_data <- simulate_edge_model_mixture("binary", num_components = 2, component_weights = c(0.5, 0.5))
df <- sim_data$df_sim
head(df)
hist(df$event/df$duration, breaks=20)
priors <- get_default_priors("binary")
priors
fit_edge <- edge_model(
(event | duration) ~ dyad(node_1_id, node_2_id),
data=df,
data_type="binary",
priors=priors
)
fit_mixture <- edge_mixture(fit_edge, num_components=5)
library(mclust)
fit_mixture <- edge_mixture(fit_edge, num_components=5)
summary(fit_mixture)
devtools::load_all(".")
summary(fit_mixture)
devtools::load_all(".")
summary(fit_mixture)
devtools::load_all(".")
summary(fit_mixture)
devtools::load_all(".")
summary(fit_mixture)
devtools::load_all(".")
summary(fit_mixture)
