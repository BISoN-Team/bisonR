target <- target + dgamma(var_ratio, 3, 1, log=TRUE)
target
hyperparams <- c(10, 10, 10)
yhats <- sapply(1:50, function(i) f(hyperparams, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
target <- 0
target <- target + extraDistr::ddirichlet(var_slopes_norm, rep(1, length(X)), log=TRUE)
target <- target + dgamma(var_ratio, 3, 1, log=TRUE)
target
hyperparams <- c(10, 10, 10)
yhats <- sapply(1:50, function(i) f(hyperparams, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
target <- 0
target <- target + extraDistr::ddirichlet(var_slopes_norm, rep(1, length(X)), log=TRUE)
target <- target + dgamma(var_ratio, 3, 1, log=TRUE)
target
hyperparams <- c(10, 10, 10)
yhats <- sapply(1:50, function(i) f(hyperparams, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
target <- 0
target <- target + extraDistr::ddirichlet(var_slopes_norm, rep(1, length(X)), log=TRUE)
target <- target + dgamma(var_ratio, 3, 1, log=TRUE)
target
loglk <- function(hyperparams) {
yhats <- sapply(1:50, function(i) f(hyperparams, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
target <- 0
target <- target + extraDistr::ddirichlet(var_slopes_norm, rep(1, length(X)), log=TRUE)
target <- target + dgamma(var_ratio, 3, 1, log=TRUE)
-target
}
optim(hyperparams, loglk)
optim(hyperparams, loglk, method="BFGS")
hyperparams <- c(0, 0, 0)
loglk <- function(hyperparams) {
hyperparams <- exp(hyperparams)
yhats <- sapply(1:50, function(i) f(hyperparams, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
target <- 0
target <- target + extraDistr::ddirichlet(var_slopes_norm, rep(1, length(X)), log=TRUE)
target <- target + dgamma(var_ratio, 3, 1, log=TRUE)
-target
}
optim(hyperparams, loglk, method="BFGS")
hyperparams_opt <- c(1.01, 0.73, 2.26)
loglk(hyperparams_opt)
f(hyperparams_opt, X)
var(f(hyperparams_opt, X))
var(f(hyperparams_opt, X))
var(f(hyperparams_opt, X))
var(f(hyperparams_opt, X))
var(f(hyperparams_opt, X))
var(f(hyperparams_opt, X))
hyperparams_opt <- c(1.01, 0.73, 2.26)
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
var_slopes_norm
var_slopes
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
x1 <- rnorm(100)
x2 <- rnorm(100, sd=2)
x3 <- rnorm(100)
X <- list(x1, x2, x3)
y <- rnorm(100, x1 + 2 * x2 + 5 * x3)
f <- function(hyperparams, X) {
beta_1 <- rnorm(1, 0, hyperparams[1])
beta_2 <- rnorm(1, 0, hyperparams[2])
beta_3 <- rnorm(1, 0, hyperparams[3])
yhat <- rnorm(100, beta_1 * X[[1]] + beta_2 * X[[2]] + beta_3 * X[[3]])
yhat
}
hyperparams <- c(0, 0, 0)
loglk <- function(hyperparams) {
hyperparams <- exp(hyperparams)
yhats <- sapply(1:50, function(i) f(hyperparams, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
target <- 0
target <- target + extraDistr::ddirichlet(var_slopes_norm, rep(1, length(X)), log=TRUE)
target <- target + dgamma(var_ratio, 3, 1, log=TRUE)
-target
}
optim_obj <- optim(hyperparams, loglk, method="BFGS")
optim_obj
hyperparams_opt <- exp(optim_obj$par)
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
var_slopes_norm
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
yhats
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
hyperparams_opt <- exp(optim_obj$par)
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
var_slopes_norm
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
var_slopes_norm
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
var_slopes_norm
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
var_slopes_norm
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
var_slopes_norm
optim_obj <- optim(hyperparams, loglk, method="BFGS")
hyperparams_opt <- exp(optim_obj$par)
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_ratio
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
var_slopes_norm
savehistory("~/Desktop/Untitled.Rhistory")
x1 <- rnorm(100)
x2 <- rnorm(100, sd=2)
x3 <- rnorm(100)
X <- list(x1, x2, x3)
y <- rnorm(100, x1 + 2 * x2 + 5 * x3)
f <- function(hyperparams, X) {
beta_1 <- rnorm(1, 0, hyperparams[1])
beta_2 <- rnorm(1, 0, hyperparams[2])
beta_3 <- rnorm(1, 0, hyperparams[3])
yhat <- rnorm(100, beta_1 * X[[1]] + beta_2 * X[[2]] + beta_3 * X[[3]])
yhat
}
hyperparams <- c(0, 0, 0)
loglk <- function(hyperparams) {
hyperparams <- exp(hyperparams)
yhats <- sapply(1:50, function(i) f(hyperparams, X))
var_ratio <- mean(apply(yhats, 2, var))/var(y)
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes
var_slopes_norm <- var_slopes/sum(var_slopes)
target <- 0
target <- target + extraDistr::ddirichlet(var_slopes_norm, rep(1, length(X)), log=TRUE)
target <- target + dgamma(var_ratio, 3, 1, log=TRUE)
-target
}
optim_obj <- optim(hyperparams, loglk, method="BFGS")
optim_obj
hyperparams_opt <- exp(optim_obj$par)
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- var(sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]]))
}
var_slopes_norm <- var_slopes/sum(var_slopes)
var_slopes_norm
hyperparams <- exp(hyperparams)
yhats <- sapply(1:50, function(i) f(hyperparams, X))
yhats
apply(yhats, 2, var)/var(y)
sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]])
lm(yhats[, j] ~ X[[i]])
lm(yhats[, 1] ~ X[[1]])
lm(yhats[, 1] ~ X[[1]])$coefficients
se(lm(yhats[, 1] ~ X[[1]]))
summary(lm(yhats[, 1] ~ X[[1]])
)
summary(lm(yhats[, 1] ~ X[[1]]))
summary(lm(yhats[, 1] ~ X[[1]]))$coefficients
summary(lm(yhats[, 1] ~ X[[1]]))$coefficients[2, 1]
summary(lm(yhats[, 1] ~ X[[1]]))$coefficients[2, 2]
summary(lm(yhats[, 1] ~ X[[1]]))$coefficients[2, 2]^2
sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]])
var_slopes <- c()
for (i in 1:length(X)) {
var_slopes[i] <- sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]])
}
var_slopes <- list()
for (i in 1:length(X)) {
var_slopes[i] <- sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]])
}
var_slopes <- list()
for (i in 1:length(X)) {
var_slopes[[i]] <- sapply(1:ncol(yhats), function(j) lm(yhats[, j] ~ X[[i]])$coefficients[[2]])
}
var_slopes
cbind(var_slopes)
rbind(var_slopes)
col_bind(var_slopes)
dplyr::col_bind(var_slopes)
dplyr::bind_cols(var_slopes)
sapply(1:ncol(yhats), function(j) summary(lm(yhats[, j] ~ X[[i]]))$coefficients[2, 2])
var_slopes <- list()
for (i in 1:length(X)) {
var_slopes[[i]] <- sapply(1:ncol(yhats), function(j) summary(lm(yhats[, j] ~ X[[i]]))$coefficients[2, 2])
}
dplyr::bind_cols(var_slopes)
apply(var_slopes, 2, mean)
var_slopes <- dplyr::bind_cols(var_slopes)
apply(var_slopes, 2, mean)
apply(var_slopes, 1, sum)
var_slopes/apply(var_slopes, 1, sum)
rowSums(var_slopes/apply(var_slopes, 1, sum))
var_slopes/apply(var_slopes, 1, sum)
var_slopes/apply(var_slopes, 1, sum)
var_slopes <- var_slopes/apply(var_slopes, 1, sum)
var_slopes <- list()
for (i in 1:length(X)) {
var_slopes[[i]] <- sapply(1:ncol(yhats), function(j) summary(lm(yhats[, j] ~ X[[i]]))$coefficients[2, 2])
}
var_slopes <- dplyr::bind_cols(var_slopes)
var_slopes <- var_slopes/apply(var_slopes, 1, sum)
var_ratio <- apply(yhats, 2, var)/var(y)
var_slopes <- list()
for (i in 1:length(X)) {
var_slopes[[i]] <- sapply(1:ncol(yhats), function(j) summary(lm(yhats[, j] ~ X[[i]]))$coefficients[2, 2])
}
var_slopes <- dplyr::bind_cols(var_slopes)
var_slopes_norm <- var_slopes/apply(var_slopes, 1, sum)
var_slopes_norm
extraDistr::ddirichlet(var_slopes_norm, rep(1, length(X)), log=TRUE)
var_slopes_norm
extraDistr::ddirichlet(var_slopes_norm[1, ], rep(1, length(X)), log=TRUE)
extraDistr::ddirichlet(var_slopes_norm[2, ], rep(1, length(X)), log=TRUE)
rep(1, length(X))
var_slopes_norm[2, ]
var_slopes_norm[1, ]
extraDistr::ddirichlet(var_slopes_norm[1, ], rep(2, length(X)), log=TRUE)
extraDistr::ddirichlet(var_slopes_norm[2, ], rep(2, length(X)), log=TRUE)
target <- target + extraDistr::ddirichlet(var_slopes_norm, rep(2, length(X)), log=TRUE)
extraDistr::ddirichlet(var_slopes_norm, rep(2, length(X)), log=TRUE)
dgamma(var_ratio, 3, 1, log=TRUE)
sum(dgamma(var_ratio, 3, 1, log=TRUE))
hyperparams <- c(0, 0, 0)
loglk <- function(hyperparams) {
hyperparams <- exp(hyperparams)
yhats <- sapply(1:50, function(i) f(hyperparams, X))
var_ratio <- apply(yhats, 2, var)/var(y)
var_slopes <- list()
for (i in 1:length(X)) {
var_slopes[[i]] <- sapply(1:ncol(yhats), function(j) summary(lm(yhats[, j] ~ X[[i]]))$coefficients[2, 2])
}
var_slopes <- dplyr::bind_cols(var_slopes)
var_slopes_norm <- var_slopes/apply(var_slopes, 1, sum)
target <- 0
target <- target + sum(extraDistr::ddirichlet(var_slopes_norm, rep(2, length(X)), log=TRUE))
target <- target + sum(dgamma(var_ratio, 3, 1, log=TRUE))
-target
}
optim_obj <- optim(hyperparams, loglk, method="BFGS")
x1 <- rnorm(100)
x2 <- rnorm(100, sd=2)
x3 <- rnorm(100)
X <- list(x1, x2, x3)
y <- rnorm(100, x1 + 2 * x2 + 5 * x3)
f <- function(hyperparams, X) {
beta_1 <- rnorm(1, 0, hyperparams[1])
beta_2 <- rnorm(1, 0, hyperparams[2])
beta_3 <- rnorm(1, 0, hyperparams[3])
yhat <- rnorm(100, beta_1 * X[[1]] + beta_2 * X[[2]] + beta_3 * X[[3]])
yhat
}
hyperparams <- c(0, 0, 0)
loglk <- function(hyperparams) {
hyperparams <- exp(hyperparams)
yhats <- sapply(1:50, function(i) f(hyperparams, X))
var_ratio <- apply(yhats, 2, var)/var(y)
var_slopes <- list()
for (i in 1:length(X)) {
var_slopes[[i]] <- sapply(1:ncol(yhats), function(j) summary(lm(yhats[, j] ~ X[[i]]))$coefficients[2, 2]^2)
}
var_slopes <- dplyr::bind_cols(var_slopes)
var_slopes_norm <- var_slopes/apply(var_slopes, 1, sum)
target <- 0
target <- target + sum(extraDistr::ddirichlet(var_slopes_norm, rep(2, length(X)), log=TRUE))
target <- target + sum(dgamma(var_ratio, 3, 1, log=TRUE))
-target
}
optim_obj <- optim(hyperparams, loglk, method="BFGS")
warnings()
optim_obj
loglk <- function(hyperparams) {
print(hyperparams)
hyperparams <- exp(hyperparams)
yhats <- sapply(1:50, function(i) f(hyperparams, X))
var_ratio <- apply(yhats, 2, var)/var(y)
var_slopes <- list()
for (i in 1:length(X)) {
var_slopes[[i]] <- sapply(1:ncol(yhats), function(j) summary(lm(yhats[, j] ~ X[[i]]))$coefficients[2, 2]^2)
}
var_slopes <- dplyr::bind_cols(var_slopes)
var_slopes_norm <- var_slopes/apply(var_slopes, 1, sum)
target <- 0
target <- target + sum(extraDistr::ddirichlet(var_slopes_norm, rep(2, length(X)), log=TRUE))
target <- target + sum(dgamma(var_ratio, 3, 1, log=TRUE))
-target
}
optim_obj <- optim(hyperparams, loglk, method="BFGS")
loglk <- function(hyperparams) {
hyperparams <- exp(hyperparams)
yhats <- sapply(1:50, function(i) f(hyperparams, X))
var_ratio <- apply(yhats, 2, var)/var(y)
var_slopes <- list()
for (i in 1:length(X)) {
var_slopes[[i]] <- sapply(1:ncol(yhats), function(j) summary(lm(yhats[, j] ~ X[[i]]))$coefficients[2, 2]^2)
}
var_slopes <- dplyr::bind_cols(var_slopes)
var_slopes_norm <- var_slopes/apply(var_slopes, 1, sum)
target <- 0
target <- target + sum(extraDistr::ddirichlet(var_slopes_norm, rep(2, length(X)), log=TRUE))
target <- target + sum(dgamma(var_ratio, 3, 1, log=TRUE))
-target
}
optim_obj <- optim(hyperparams, loglk)
optim_obj
optim_obj <- optim(hyperparams, loglk)
optim_obj
hyperparams_opt <- exp(optim_obj$par)
yhats <- sapply(1:50, function(i) f(hyperparams_opt, X))
yhats
apply(yhats, 2, var)/var(y)
plot(density(apply(yhats, 2, var)/var(y)))
plot(curve(dgamma(x, 3, 1)))
plot(curve(dgamma(x, 3, 1)), from=0, to=3)
curve(dgamma(x, 3, 1)), from=0, to=3)
curve(dgamma(x, 3, 1), from=0, to=3)
plot(density(apply(yhats, 2, var)/var(y)))
